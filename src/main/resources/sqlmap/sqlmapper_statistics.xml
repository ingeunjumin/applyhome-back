<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- MyBatis에게 Mapper 경로를 적어야 한다. -->
<mapper namespace="com.ingeunjumin.project.mapper.StatisticsMapper">

	<!-- 6개월 매매 평균 금액 조회 -->
	<select id="selectSixMonthStatistics" resultType="map">
	SELECT
		ROUND(AVG(sale_price)) AS monthAvgAmount,
		DATE_FORMAT(create_at,'%Y-%m') AS month
	FROM 
		history_sale_contract
	WHERE 
		DATE_FORMAT(create_at,'%Y-%m') BETWEEN #{startDate} AND #{endDate}
	GROUP BY DATE_FORMAT(create_at,'%Y-%m')
	ORDER BY DATE_FORMAT(create_at,'%Y-%m')
	</select>
	
	<!-- 월별 지역마다 매매 건수 구하기 -->
	<select id="selectSixMonthAptSellStatistics" resultType="map">
	SELECT	
		count(*) AS monthCountAptSales,
		DATE_FORMAT(create_at,'%Y-%m') AS month,
		gu
	FROM 
		history_sale_contract
	WHERE 
		DATE_FORMAT(create_at,'%Y-%m') BETWEEN '2021-01' AND '2021-06'
	GROUP BY DATE_FORMAT(create_at,'%Y-%m'), gu
	ORDER BY DATE_FORMAT(create_at,'%Y-%m')
	</select>

    
</mapper>