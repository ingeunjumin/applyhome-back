<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- API 전용 sql -->
<mapper namespace="com.ingeunjumin.project.api.ApiMapper">

    <select id="selectAllApartments" resultType="map">
	    SELECT 
			apartments_no AS apartmentsNo,
			apartments_name AS apartmentsName, 
			latitude,
			longitude
		FROM apartments 
    </select>
    
   	<select id="selectOneApartments" resultType="map">
   		SELECT 
			apartments_no AS apartmentsNo,
			apartments_name AS apartmentsName,
			price,
			addr,
			gu,
			dong,
			create_at AS createAt
		FROM apartments 
		WHERE apartments_no = #{apartmentsNo}
   	</select>
    
    <select id="selectApartmentsContract" resultType="map">
    	SELECT 
			a.apartments_no AS apartmentsNo,
			a.apartments_name AS apartmentsName,
			hs.sale_price AS salePrice,
			hs.gu,
			hs.dong,
			hs.create_at AS createAt
		FROM apartments AS a
		INNER JOIN history_sale_contract AS hs
		ON a.apartments_no = hs.apartments_no 
		WHERE a.apartments_no = #{apartmentsNo}
		AND DATE_FORMAT(hs.create_at,'%Y-%m-%d') >= #{date}
		ORDER BY hs.create_at DESC
    </select>
    
</mapper>